# 🧪 TEST_OVERVIEW.md

## 概要

本ドキュメントは、本プロジェクトのテスト全体像をまとめたものです。  
ユニットテスト・結合テスト・E2E テストを段階的に設計・実装し、品質保証と回帰防止を目的とします。

---

## ✅ テスト分類と目的

| テスト種類     | 対象範囲                              | 使用ツール              | 主な目的                                      |
|----------------|---------------------------------------|--------------------------|-----------------------------------------------|
| ユニットテスト | 単体関数・入力バリデーションなど       | Vitest                   | 関数単位のロジック確認、入力と出力の正確性   |
| 結合テスト     | Express ルーター、DBアクセス付きAPI    | Vitest + Supertest       | APIエンドポイントの一連処理の検証             |
| E2Eテスト      | Next.js UI + Firebase + Express 通信全体 | Playwright               | ユーザー操作と認可フローの一貫性テスト        |

---

## 📁 テスト構成ディレクトリ

```plaintext
tests/
├── unit/               # 純粋関数・ユーティリティのテスト
├── integration/        # Express API と DB の結合テスト
├── e2e/                # Playwright によるユーザー操作テスト
```

---

## 🔍 各テスト対象の概要
1. ユニットテスト（Vitest）
- Firebase トークン取得ロジック
- カテゴリ名のバリデーション関数
- APIレスポンス整形関数

2. 結合テスト（Supertest）
- /api/auth/verify：トークン検証と認可レスポンス
- /api/admin/categories：POST/GET/DELETE のCRUD挙動
- Prisma 経由の DB との一貫性確認

3. E2Eテスト（Playwright）
- ログインページの動作確認（成功／失敗）
- 管理者ページのアクセス制限検証
- UI要素の表示・遷移テスト

---

## 🎯 品質方針（OECD + α）

| 観点                      | 方針例                                                               |                        
| --------------------------| ------------------------------------------------------------------- |
| 正確性（Accuracy）         | バリデーション通過時の期待レスポンスを保証                              |
| 完全性（Completeness）     | 必須項目が欠落した場合の適切なエラー処理                                |
| 一貫性（Consistency）      | 同じ入力に対して常に同じ結果を返すこと（冪等性）                         |
| 耐障害性（Robustness）     | 無効なトークンや不正な入力でクラッシュせず、安全な応答を返す              |
| 効率性（Efficiency）       | レスポンスタイムが妥当であり、CI実行でも安定して通過すること（参考観点）   |

---

## 🛠 使用技術
- Vitest：単体・結合テスト用
- Supertest：Express API テスト用 HTTP クライアント
- Playwright：UI操作とルーティングの E2E テスト
- msw（任意）：モック API のテスト用スタブ化

---

## 📦 今後の拡張候補
- カバレッジ測定（vitest --coverage）
- テスト用モックDBの導入
- クロスブラウザE2Eテスト（Playwrightの機能）
- パフォーマンステスト／ロードテストの計画



